/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package proyectop2_miniaccess_miaelvir_alereyes;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.nio.Buffer;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Scanner;
import javax.swing.JDialog;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeModel;
import javax.swing.tree.TreePath;

/**
 *
 * @author aleja
 */
public class PaginaInicio extends javax.swing.JFrame {
    ArrayList <Usuario> usuarios = new ArrayList();
    


    /**
     * Creates new form PaginaInicio
     */
    //hola esto deberia guardarse
    public PaginaInicio() {
        initComponents();
        jd_espaciodetrabajo.setSize(1100, 696);
        this.setLocationRelativeTo(null);
        Usuario mia = new Usuario("papoy", "pato"); 
        Usuario ale = new Usuario("papita", "salsa"); 
        mia.getPermisos().add("Gestion de Nuevos Usuarios"); 
        mia.getPermisos().add("Create"); 
        mia.getPermisos().add("Select"); 
        mia.getPermisos().add("Insert"); 
        mia.getPermisos().add("Delete"); 
        mia.getPermisos().add("Drop"); 
        ale.getPermisos().add("Gestion de Nuevos Usuarios"); 
        ale.getPermisos().add("Create"); 
        ale.getPermisos().add("Select"); 
        ale.getPermisos().add("Insert"); 
        ale.getPermisos().add("Delete"); 
        ale.getPermisos().add("Drop");       
        usuarios.add(mia); 
        usuarios.add(ale); 
        
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jd_crearusuario = new javax.swing.JDialog();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        tf_crearnombreusuario = new javax.swing.JTextField();
        pf_contracrearusuario = new javax.swing.JPasswordField();
        bt_crear = new javax.swing.JButton();
        jd_error = new javax.swing.JDialog();
        jl_error = new javax.swing.JLabel();
        bt_ok = new javax.swing.JButton();
        jLabel8 = new javax.swing.JLabel();
        jd_inicio = new javax.swing.JDialog();
        jPanel5 = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();
        jSeparator1 = new javax.swing.JSeparator();
        bt_cuentapginicio = new javax.swing.JButton();
        bt_opcionespginicio = new javax.swing.JButton();
        jLabel11 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        bt_iniciopginicio = new javax.swing.JButton();
        jLabel13 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        bt_nuevopginicio = new javax.swing.JButton();
        jLabel14 = new javax.swing.JLabel();
        jl_abrir = new javax.swing.JLabel();
        bt_abrirpginicio = new javax.swing.JButton();
        jLabel9 = new javax.swing.JLabel();
        jl_bienvenido = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel7 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jt_ArbolInicio = new javax.swing.JTree();
        jPanel8 = new javax.swing.JPanel();
        bt_nuevoBase = new javax.swing.JButton();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        jMenuItem1 = new javax.swing.JMenuItem();
        jMenu2 = new javax.swing.JMenu();
        jd_espaciodetrabajo = new javax.swing.JDialog();
        jPanel9 = new javax.swing.JPanel();
        jToolBar1 = new javax.swing.JToolBar();
        bt_newdatabase = new javax.swing.JButton();
        bt_newdatabase1 = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        jTabbedPane2 = new javax.swing.JTabbedPane();
        jPanel10 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jtree_baseddatos = new javax.swing.JTree();
        jPanel11 = new javax.swing.JPanel();
        jTabbedPane3 = new javax.swing.JTabbedPane();
        jPanel12 = new javax.swing.JPanel();
        jToolBar2 = new javax.swing.JToolBar();
        bt_clear = new javax.swing.JButton();
        bt_send = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        tp_sql = new javax.swing.JTextPane();
        jScrollPane3 = new javax.swing.JScrollPane();
        tabla_esptrabajo = new javax.swing.JTable();
        jMenuBar2 = new javax.swing.JMenuBar();
        jMenu3 = new javax.swing.JMenu();
        jMenu4 = new javax.swing.JMenu();
        popup_tablasenarbol = new javax.swing.JPopupMenu();
        jmi_eliminarbase = new javax.swing.JMenuItem();
        jd_cuenta = new javax.swing.JDialog();
        jPanel13 = new javax.swing.JPanel();
        jPanel14 = new javax.swing.JPanel();
        jLabel22 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jl_usuarioCuenta = new javax.swing.JLabel();
        jl_contraseñaCuenta = new javax.swing.JLabel();
        jd_baseUsuarios = new javax.swing.JDialog();
        jPanel15 = new javax.swing.JPanel();
        jPanel16 = new javax.swing.JPanel();
        tf_usuarioBase = new javax.swing.JTextField();
        jLabel15 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        bt_crearuserBase = new javax.swing.JButton();
        jPanel17 = new javax.swing.JPanel();
        cb_gestionUsuarios = new javax.swing.JCheckBox();
        cb_create = new javax.swing.JCheckBox();
        cb_select = new javax.swing.JCheckBox();
        cb_insert = new javax.swing.JCheckBox();
        cb_drop = new javax.swing.JCheckBox();
        cb_delete1 = new javax.swing.JCheckBox();
        pf_contraUser = new javax.swing.JPasswordField();
        popup_opcionesBases = new javax.swing.JPopupMenu();
        jmi_AgregarUsuario = new javax.swing.JMenuItem();
        jmi_cambiarUsuario = new javax.swing.JMenuItem();
        jmi_AgregarTabla = new javax.swing.JMenuItem();
        jmi_eliminarBase = new javax.swing.JMenuItem();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        pf_contra = new javax.swing.JPasswordField();
        tf_usuarioo = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        bt_ingresar = new javax.swing.JButton();
        bt_notengousuario = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();

        jPanel3.setBackground(new java.awt.Color(249, 187, 218));

        jPanel4.setBackground(new java.awt.Color(255, 255, 255));

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        jLabel5.setFont(new java.awt.Font("Bell MT", 0, 30)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(0, 0, 0));
        jLabel5.setText("Crear Usuario");

        jLabel6.setFont(new java.awt.Font("Bell MT", 0, 20)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(0, 0, 0));
        jLabel6.setText("Usuario");

        jLabel7.setFont(new java.awt.Font("Bell MT", 0, 20)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(0, 0, 0));
        jLabel7.setText("Contraseña");

        tf_crearnombreusuario.setBackground(new java.awt.Color(0, 0, 0));
        tf_crearnombreusuario.setForeground(new java.awt.Color(255, 255, 255));

        pf_contracrearusuario.setBackground(new java.awt.Color(0, 0, 0));
        pf_contracrearusuario.setForeground(new java.awt.Color(255, 255, 255));

        bt_crear.setBackground(new java.awt.Color(255, 153, 204));
        bt_crear.setFont(new java.awt.Font("Bell MT", 1, 16)); // NOI18N
        bt_crear.setForeground(new java.awt.Color(0, 0, 0));
        bt_crear.setText("Crear");
        bt_crear.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_crearActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGap(29, 29, 29)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel7)
                            .addComponent(jLabel6))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(tf_crearnombreusuario)
                            .addComponent(pf_contracrearusuario, javax.swing.GroupLayout.DEFAULT_SIZE, 181, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                        .addContainerGap(109, Short.MAX_VALUE)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                                .addComponent(jLabel5)
                                .addGap(73, 73, 73))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                                .addComponent(bt_crear, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(56, 56, 56)))))
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(38, 38, 38)
                .addComponent(jLabel5)
                .addGap(69, 69, 69)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(tf_crearnombreusuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6))
                .addGap(36, 36, 36)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(pf_contracrearusuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(29, 29, 29)
                .addComponent(bt_crear)
                .addContainerGap(69, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jd_crearusuarioLayout = new javax.swing.GroupLayout(jd_crearusuario.getContentPane());
        jd_crearusuario.getContentPane().setLayout(jd_crearusuarioLayout);
        jd_crearusuarioLayout.setHorizontalGroup(
            jd_crearusuarioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jd_crearusuarioLayout.setVerticalGroup(
            jd_crearusuarioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jd_error.getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jl_error.setFont(new java.awt.Font("Lucida Sans Typewriter", 1, 14)); // NOI18N
        jl_error.setForeground(new java.awt.Color(0, 0, 0));
        jl_error.setText("*texto aqui*\n");
        jd_error.getContentPane().add(jl_error, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 50, 290, 70));

        bt_ok.setBackground(new java.awt.Color(253, 220, 220));
        bt_ok.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        bt_ok.setForeground(new java.awt.Color(0, 0, 0));
        bt_ok.setText("OK ");
        bt_ok.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_okMouseClicked(evt);
            }
        });
        jd_error.getContentPane().add(bt_ok, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 130, 130, 30));

        jLabel8.setForeground(new java.awt.Color(0, 0, 0));
        jLabel8.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/ErrorMensaje.png"))); // NOI18N
        jLabel8.setText("si");
        jd_error.getContentPane().add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 360, 170));

        jd_inicio.getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
        jPanel5.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel6.setBackground(new java.awt.Color(255, 204, 204));
        jPanel6.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jPanel6.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jSeparator1.setForeground(new java.awt.Color(255, 102, 102));
        jSeparator1.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jPanel6.add(jSeparator1, new org.netbeans.lib.awtextra.AbsoluteConstraints(15, 451, 119, 13));

        bt_cuentapginicio.setBackground(new java.awt.Color(255, 204, 204));
        bt_cuentapginicio.setFont(new java.awt.Font("Bell MT", 3, 15)); // NOI18N
        bt_cuentapginicio.setForeground(new java.awt.Color(0, 0, 0));
        bt_cuentapginicio.setText("Cuenta");
        bt_cuentapginicio.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_cuentapginicioMouseClicked(evt);
            }
        });
        bt_cuentapginicio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_cuentapginicioActionPerformed(evt);
            }
        });
        jPanel6.add(bt_cuentapginicio, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 470, 146, 23));

        bt_opcionespginicio.setBackground(new java.awt.Color(255, 204, 204));
        bt_opcionespginicio.setFont(new java.awt.Font("Bell MT", 3, 14)); // NOI18N
        bt_opcionespginicio.setForeground(new java.awt.Color(0, 0, 0));
        bt_opcionespginicio.setText("Opciones");
        jPanel6.add(bt_opcionespginicio, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 499, 146, 21));

        jLabel11.setFont(new java.awt.Font("Bell MT", 1, 18)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(255, 102, 102));
        jLabel11.setText("Inicio");
        jPanel6.add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 100, 50, 20));

        jLabel10.setForeground(new java.awt.Color(0, 0, 0));
        jLabel10.setText("jLabel10");
        jPanel6.add(jLabel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 50, 70, 50));

        bt_iniciopginicio.setBackground(new java.awt.Color(255, 204, 204));
        bt_iniciopginicio.setAlignmentX(2.0F);
        bt_iniciopginicio.setAlignmentY(2.0F);
        bt_iniciopginicio.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_iniciopginicio.setIconTextGap(5);
        bt_iniciopginicio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_iniciopginicioActionPerformed(evt);
            }
        });
        jPanel6.add(bt_iniciopginicio, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 40, 152, 96));

        jLabel13.setForeground(new java.awt.Color(0, 0, 0));
        jLabel13.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/folder pequeño inicio.png"))); // NOI18N
        jLabel13.setText("jLabel13");
        jPanel6.add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 160, 50, 50));

        jLabel12.setFont(new java.awt.Font("Bell MT", 1, 18)); // NOI18N
        jLabel12.setForeground(new java.awt.Color(255, 102, 102));
        jLabel12.setText("Nuevo");
        jPanel6.add(jLabel12, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 220, -1, -1));

        bt_nuevopginicio.setBackground(new java.awt.Color(255, 204, 204));
        bt_nuevopginicio.setAlignmentX(2.0F);
        bt_nuevopginicio.setAlignmentY(2.0F);
        bt_nuevopginicio.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_nuevopginicio.setIconTextGap(5);
        bt_nuevopginicio.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_nuevopginicioMouseClicked(evt);
            }
        });
        jPanel6.add(bt_nuevopginicio, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 153, 152, 96));

        jLabel14.setFont(new java.awt.Font("Bell MT", 1, 18)); // NOI18N
        jLabel14.setForeground(new java.awt.Color(255, 102, 102));
        jLabel14.setText(" Abrir");
        jPanel6.add(jLabel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 320, 50, -1));

        jl_abrir.setForeground(new java.awt.Color(0, 0, 0));
        jl_abrir.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/carpeta pequeña.png"))); // NOI18N
        jl_abrir.setText("jLabel15");
        jl_abrir.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jl_abrirMouseClicked(evt);
            }
        });
        jPanel6.add(jl_abrir, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 260, 50, 50));

        bt_abrirpginicio.setBackground(new java.awt.Color(255, 204, 204));
        bt_abrirpginicio.setAlignmentX(2.0F);
        bt_abrirpginicio.setAlignmentY(2.0F);
        bt_abrirpginicio.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_abrirpginicio.setIconTextGap(5);
        jPanel6.add(bt_abrirpginicio, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 257, 152, 96));

        jPanel5.add(jPanel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, -1, 530));

        jLabel9.setFont(new java.awt.Font("Bell MT", 1, 24)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(0, 0, 0));
        jLabel9.setText("Bienvenid@");
        jPanel5.add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(190, 30, -1, -1));

        jl_bienvenido.setFont(new java.awt.Font("Bell MT", 1, 24)); // NOI18N
        jl_bienvenido.setForeground(new java.awt.Color(0, 0, 0));
        jl_bienvenido.setText("Ale/Mia");
        jPanel5.add(jl_bienvenido, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 30, 179, -1));

        jTabbedPane1.setBackground(new java.awt.Color(255, 204, 204));
        jTabbedPane1.setForeground(new java.awt.Color(0, 0, 0));
        jTabbedPane1.setFont(new java.awt.Font("Bell MT", 3, 14)); // NOI18N

        jPanel7.setBackground(new java.awt.Color(252, 223, 223));
        jPanel7.setForeground(new java.awt.Color(255, 233, 233));

        jt_ArbolInicio.setBackground(new java.awt.Color(255, 255, 255));
        jt_ArbolInicio.setForeground(new java.awt.Color(204, 204, 255));
        javax.swing.tree.DefaultMutableTreeNode treeNode1 = new javax.swing.tree.DefaultMutableTreeNode("Archivos");
        jt_ArbolInicio.setModel(new javax.swing.tree.DefaultTreeModel(treeNode1));
        jScrollPane2.setViewportView(jt_ArbolInicio);

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 658, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 233, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("Recientes", jPanel7);

        jPanel8.setBackground(new java.awt.Color(253, 219, 219));

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 670, Short.MAX_VALUE)
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 245, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("Anclados", jPanel8);

        jPanel5.add(jTabbedPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 230, 670, 280));

        bt_nuevoBase.setBackground(new java.awt.Color(255, 255, 255));
        bt_nuevoBase.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/folder rosa.png"))); // NOI18N
        bt_nuevoBase.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_nuevoBaseMouseClicked(evt);
            }
        });
        bt_nuevoBase.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_nuevoBaseActionPerformed(evt);
            }
        });
        jPanel5.add(bt_nuevoBase, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 70, 120, 110));

        jLabel16.setText("jLabel16");
        jPanel5.add(jLabel16, new org.netbeans.lib.awtextra.AbsoluteConstraints(223, 86, 90, 100));

        jLabel17.setFont(new java.awt.Font("Segoe UI", 1, 10)); // NOI18N
        jLabel17.setForeground(new java.awt.Color(0, 0, 0));
        jLabel17.setText("Abrir espacio de trabajo");
        jPanel5.add(jLabel17, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 190, 120, -1));

        jd_inicio.getContentPane().add(jPanel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 900, 530));

        jMenuBar1.setBackground(new java.awt.Color(255, 255, 255));
        jMenuBar1.setForeground(new java.awt.Color(0, 0, 0));

        jMenu1.setText("Opciones");
        jMenu1.setFont(new java.awt.Font("Bell MT", 2, 14)); // NOI18N

        jMenuItem1.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_N, java.awt.event.InputEvent.CTRL_DOWN_MASK));
        jMenuItem1.setText("Crear Nueva Base ");
        jMenu1.add(jMenuItem1);

        jMenuBar1.add(jMenu1);

        jMenu2.setText("Ayuda");
        jMenu2.setFont(new java.awt.Font("Bell MT", 2, 14)); // NOI18N
        jMenuBar1.add(jMenu2);

        jd_inicio.setJMenuBar(jMenuBar1);

        jPanel9.setBackground(new java.awt.Color(255, 255, 255));

        jToolBar1.setBackground(new java.awt.Color(255, 204, 204));
        jToolBar1.setRollover(true);

        bt_newdatabase.setBackground(new java.awt.Color(0, 0, 0));
        bt_newdatabase.setFont(new java.awt.Font("Calibri Light", 1, 12)); // NOI18N
        bt_newdatabase.setText("+ New Database");
        bt_newdatabase.setFocusable(false);
        bt_newdatabase.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_newdatabase.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        bt_newdatabase.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_newdatabaseMouseClicked(evt);
            }
        });
        jToolBar1.add(bt_newdatabase);

        bt_newdatabase1.setBackground(new java.awt.Color(0, 0, 0));
        bt_newdatabase1.setFont(new java.awt.Font("Calibri Light", 1, 12)); // NOI18N
        bt_newdatabase1.setText("+ New Database");
        bt_newdatabase1.setFocusable(false);
        bt_newdatabase1.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_newdatabase1.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        bt_newdatabase1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_newdatabase1MouseClicked(evt);
            }
        });
        jToolBar1.add(bt_newdatabase1);

        jButton1.setBackground(new java.awt.Color(0, 0, 0));
        jButton1.setFont(new java.awt.Font("Calibri Light", 1, 12)); // NOI18N
        jButton1.setText("Cambiar de Usuario");
        jButton1.setFocusable(false);
        jButton1.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jButton1.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jToolBar1.add(jButton1);

        jTabbedPane2.setBackground(new java.awt.Color(255, 153, 153));
        jTabbedPane2.setForeground(new java.awt.Color(0, 0, 0));
        jTabbedPane2.setFont(new java.awt.Font("Bell MT", 3, 14)); // NOI18N

        jPanel10.setBackground(new java.awt.Color(255, 204, 204));

        jtree_baseddatos.setBackground(new java.awt.Color(255, 255, 255));
        jtree_baseddatos.setForeground(new java.awt.Color(0, 0, 0));
        treeNode1 = new javax.swing.tree.DefaultMutableTreeNode("Bases de Datos");
        jtree_baseddatos.setModel(new javax.swing.tree.DefaultTreeModel(treeNode1));
        jtree_baseddatos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jtree_baseddatosMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jtree_baseddatos);

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 198, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 397, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane2.addTab("Databases", jPanel10);

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 210, Short.MAX_VALUE)
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 409, Short.MAX_VALUE)
        );

        jTabbedPane2.addTab("tab2", jPanel11);

        jToolBar2.setRollover(true);

        bt_clear.setText("clear");
        bt_clear.setFocusable(false);
        bt_clear.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_clear.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        bt_clear.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_clearMouseClicked(evt);
            }
        });
        jToolBar2.add(bt_clear);

        bt_send.setText("send");
        bt_send.setFocusable(false);
        bt_send.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        bt_send.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        bt_send.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_sendMouseClicked(evt);
            }
        });
        jToolBar2.add(bt_send);

        tp_sql.setBackground(new java.awt.Color(255, 255, 255));
        tp_sql.addInputMethodListener(new java.awt.event.InputMethodListener() {
            public void caretPositionChanged(java.awt.event.InputMethodEvent evt) {
            }
            public void inputMethodTextChanged(java.awt.event.InputMethodEvent evt) {
                tp_sqlInputMethodTextChanged(evt);
            }
        });
        jScrollPane4.setViewportView(tp_sql);

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addComponent(jToolBar2, javax.swing.GroupLayout.PREFERRED_SIZE, 144, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane4)
                .addContainerGap())
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel12Layout.createSequentialGroup()
                .addComponent(jToolBar2, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 96, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane3.addTab("SQL", jPanel12);

        tabla_esptrabajo.setBackground(new java.awt.Color(204, 204, 204));
        tabla_esptrabajo.setForeground(new java.awt.Color(0, 0, 0));
        tabla_esptrabajo.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jScrollPane3.setViewportView(tabla_esptrabajo);

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jToolBar1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 210, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jTabbedPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 695, Short.MAX_VALUE)
                    .addComponent(jScrollPane3))
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addComponent(jToolBar1, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jTabbedPane2)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addComponent(jTabbedPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 168, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 257, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );

        jMenu3.setText("File");
        jMenuBar2.add(jMenu3);

        jMenu4.setText("Edit");
        jMenuBar2.add(jMenu4);

        jd_espaciodetrabajo.setJMenuBar(jMenuBar2);

        javax.swing.GroupLayout jd_espaciodetrabajoLayout = new javax.swing.GroupLayout(jd_espaciodetrabajo.getContentPane());
        jd_espaciodetrabajo.getContentPane().setLayout(jd_espaciodetrabajoLayout);
        jd_espaciodetrabajoLayout.setHorizontalGroup(
            jd_espaciodetrabajoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jd_espaciodetrabajoLayout.setVerticalGroup(
            jd_espaciodetrabajoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jmi_eliminarbase.setText("Eliminar ");
        jmi_eliminarbase.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_eliminarbaseActionPerformed(evt);
            }
        });
        popup_tablasenarbol.add(jmi_eliminarbase);

        jPanel13.setBackground(new java.awt.Color(255, 255, 255));
        jPanel13.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel14.setBackground(new java.awt.Color(255, 204, 255));

        jLabel22.setFont(new java.awt.Font("Segoe UI Black", 0, 14)); // NOI18N
        jLabel22.setForeground(new java.awt.Color(0, 0, 0));
        jLabel22.setText("Informacion de La Cuenta");

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 230, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(152, Short.MAX_VALUE))
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                .addContainerGap(15, Short.MAX_VALUE)
                .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel13.add(jPanel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, -1, 50));

        jLabel18.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/circulorosaclaro.png"))); // NOI18N
        jPanel13.add(jLabel18, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 100, 120, 110));

        jLabel19.setFont(new java.awt.Font("Segoe UI Black", 0, 14)); // NOI18N
        jLabel19.setForeground(new java.awt.Color(0, 0, 0));
        jLabel19.setText("Usuario");
        jPanel13.add(jLabel19, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 80, 160, -1));

        jLabel20.setFont(new java.awt.Font("Segoe UI Black", 0, 12)); // NOI18N
        jLabel20.setForeground(new java.awt.Color(0, 0, 0));
        jLabel20.setText("Contraseña");
        jPanel13.add(jLabel20, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 150, -1, -1));

        jl_usuarioCuenta.setForeground(new java.awt.Color(0, 0, 0));
        jl_usuarioCuenta.setText("jLabel21");
        jPanel13.add(jl_usuarioCuenta, new org.netbeans.lib.awtextra.AbsoluteConstraints(180, 110, 160, 30));

        jl_contraseñaCuenta.setForeground(new java.awt.Color(0, 0, 0));
        jl_contraseñaCuenta.setText("jLabel23");
        jPanel13.add(jl_contraseñaCuenta, new org.netbeans.lib.awtextra.AbsoluteConstraints(180, 180, 100, 30));

        javax.swing.GroupLayout jd_cuentaLayout = new javax.swing.GroupLayout(jd_cuenta.getContentPane());
        jd_cuenta.getContentPane().setLayout(jd_cuentaLayout);
        jd_cuentaLayout.setHorizontalGroup(
            jd_cuentaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jd_cuentaLayout.setVerticalGroup(
            jd_cuentaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, 277, Short.MAX_VALUE)
        );

        jPanel15.setBackground(new java.awt.Color(255, 255, 255));

        jPanel16.setBackground(new java.awt.Color(255, 204, 204));

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 82, Short.MAX_VALUE)
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        tf_usuarioBase.setBackground(new java.awt.Color(204, 204, 204));

        jLabel15.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel15.setForeground(new java.awt.Color(0, 0, 0));
        jLabel15.setText("Usuario");

        jLabel21.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel21.setForeground(new java.awt.Color(0, 0, 0));
        jLabel21.setText("Contraseña");

        jLabel23.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jLabel23.setForeground(new java.awt.Color(0, 0, 0));
        jLabel23.setText("Crear Usuario en Base de Datos");

        jLabel24.setFont(new java.awt.Font("Segoe UI", 1, 22)); // NOI18N
        jLabel24.setForeground(new java.awt.Color(0, 0, 0));
        jLabel24.setText("Asignar permisos");

        bt_crearuserBase.setBackground(new java.awt.Color(255, 204, 204));
        bt_crearuserBase.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        bt_crearuserBase.setForeground(new java.awt.Color(0, 0, 0));
        bt_crearuserBase.setText("Crear Usuario");
        bt_crearuserBase.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_crearuserBaseMouseClicked(evt);
            }
        });

        jPanel17.setBackground(new java.awt.Color(255, 204, 204));
        jPanel17.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        cb_gestionUsuarios.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        cb_gestionUsuarios.setForeground(new java.awt.Color(0, 0, 0));
        cb_gestionUsuarios.setText("Gestion de Nuevos Usuarios");
        jPanel17.add(cb_gestionUsuarios, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, -1, -1));

        cb_create.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        cb_create.setForeground(new java.awt.Color(0, 0, 0));
        cb_create.setText("Create ");
        jPanel17.add(cb_create, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, -1, -1));

        cb_select.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        cb_select.setForeground(new java.awt.Color(0, 0, 0));
        cb_select.setText("Select");
        jPanel17.add(cb_select, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 70, -1, -1));

        cb_insert.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        cb_insert.setForeground(new java.awt.Color(0, 0, 0));
        cb_insert.setText("Insert");
        jPanel17.add(cb_insert, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 100, -1, -1));

        cb_drop.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        cb_drop.setForeground(new java.awt.Color(0, 0, 0));
        cb_drop.setText("Drop");
        jPanel17.add(cb_drop, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 160, -1, -1));

        cb_delete1.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        cb_delete1.setForeground(new java.awt.Color(0, 0, 0));
        cb_delete1.setText("Delete");
        jPanel17.add(cb_delete1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 130, -1, -1));

        pf_contraUser.setBackground(new java.awt.Color(204, 204, 204));
        pf_contraUser.setForeground(new java.awt.Color(0, 0, 0));

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addComponent(jPanel16, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 375, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel24, javax.swing.GroupLayout.PREFERRED_SIZE, 203, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(bt_crearuserBase, javax.swing.GroupLayout.PREFERRED_SIZE, 186, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGroup(jPanel15Layout.createSequentialGroup()
                                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(jLabel21, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGap(26, 26, 26)
                                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(tf_usuarioBase, javax.swing.GroupLayout.DEFAULT_SIZE, 267, Short.MAX_VALUE)
                                        .addComponent(pf_contraUser))))))
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addGap(79, 79, 79)
                        .addComponent(jPanel17, javax.swing.GroupLayout.PREFERRED_SIZE, 217, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(24, Short.MAX_VALUE))
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addGap(31, 31, 31)
                .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(tf_usuarioBase, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel15))
                .addGap(18, 18, 18)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel21)
                    .addComponent(pf_contraUser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(31, 31, 31)
                .addComponent(jLabel24)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel17, javax.swing.GroupLayout.DEFAULT_SIZE, 188, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(bt_crearuserBase)
                .addGap(16, 16, 16))
        );

        javax.swing.GroupLayout jd_baseUsuariosLayout = new javax.swing.GroupLayout(jd_baseUsuarios.getContentPane());
        jd_baseUsuarios.getContentPane().setLayout(jd_baseUsuariosLayout);
        jd_baseUsuariosLayout.setHorizontalGroup(
            jd_baseUsuariosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jd_baseUsuariosLayout.setVerticalGroup(
            jd_baseUsuariosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jmi_AgregarUsuario.setText("Agregar Usuario");
        jmi_AgregarUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_AgregarUsuarioActionPerformed(evt);
            }
        });
        popup_opcionesBases.add(jmi_AgregarUsuario);

        jmi_cambiarUsuario.setText("Cambiar Usuario");
        jmi_cambiarUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_cambiarUsuarioActionPerformed(evt);
            }
        });
        popup_opcionesBases.add(jmi_cambiarUsuario);

        jmi_AgregarTabla.setText("Agregar Tabla");
        popup_opcionesBases.add(jmi_AgregarTabla);

        jmi_eliminarBase.setText("Eliminar Base de Datos");
        popup_opcionesBases.add(jmi_eliminarBase);

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel1.setBackground(new java.awt.Color(255, 204, 204));

        jLabel1.setFont(new java.awt.Font("Bell MT", 3, 48)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(0, 0, 0));
        jLabel1.setText("Log-In");

        jLabel2.setFont(new java.awt.Font("Bell MT", 0, 25)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(0, 0, 0));
        jLabel2.setText("Contraseña");

        jLabel3.setFont(new java.awt.Font("Bell MT", 0, 25)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(0, 0, 0));
        jLabel3.setText("Usuario");

        pf_contra.setBackground(new java.awt.Color(255, 255, 255));
        pf_contra.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pf_contraActionPerformed(evt);
            }
        });

        tf_usuarioo.setBackground(new java.awt.Color(255, 255, 255));

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 130, Short.MAX_VALUE)
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        bt_ingresar.setBackground(new java.awt.Color(255, 153, 153));
        bt_ingresar.setFont(new java.awt.Font("Segoe UI", 1, 15)); // NOI18N
        bt_ingresar.setForeground(new java.awt.Color(0, 0, 0));
        bt_ingresar.setText("Ingresar");
        bt_ingresar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_ingresarActionPerformed(evt);
            }
        });

        bt_notengousuario.setBackground(new java.awt.Color(251, 172, 172));
        bt_notengousuario.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        bt_notengousuario.setForeground(new java.awt.Color(0, 0, 0));
        bt_notengousuario.setText("No tienes un usuario? Crear usuario");
        bt_notengousuario.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bt_notengousuarioMouseClicked(evt);
            }
        });
        bt_notengousuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_notengousuarioActionPerformed(evt);
            }
        });

        jLabel4.setBackground(new java.awt.Color(255, 204, 204));
        jLabel4.setForeground(new java.awt.Color(255, 204, 204));
        jLabel4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/moñoEditado-removebg-preview.png"))); // NOI18N
        jLabel4.setText("jLabel4");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(bt_ingresar, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                                .addGap(51, 51, 51)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addComponent(bt_notengousuario)
                                        .addGap(0, 0, Short.MAX_VALUE))
                                    .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addComponent(jLabel2)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 28, Short.MAX_VALUE)
                                        .addComponent(pf_contra, javax.swing.GroupLayout.PREFERRED_SIZE, 241, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addComponent(jLabel3)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(tf_usuarioo, javax.swing.GroupLayout.PREFERRED_SIZE, 241, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                        .addGap(63, 63, 63))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(55, 55, 55))))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(39, 39, 39)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 89, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(61, 61, 61)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(tf_usuarioo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(40, 40, 40)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(pf_contra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(bt_ingresar)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 43, Short.MAX_VALUE)
                .addComponent(bt_notengousuario)
                .addGap(20, 20, 20))
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void bt_notengousuarioMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_notengousuarioMouseClicked
        
    }//GEN-LAST:event_bt_notengousuarioMouseClicked

    private void bt_okMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_okMouseClicked
        jd_error.setVisible(false);
    }//GEN-LAST:event_bt_okMouseClicked

    private void bt_cuentapginicioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_cuentapginicioActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_cuentapginicioActionPerformed

    private void bt_iniciopginicioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_iniciopginicioActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_iniciopginicioActionPerformed

    private void bt_nuevoBaseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_nuevoBaseActionPerformed
       jd_inicio.setVisible(false);
       this.setVisible(false);
       //expandir(jd_espaciodetrabajo);
       
       //jd_espaciodetrabajo.setLocationRelativeTo(this);
       jd_espaciodetrabajo.setVisible(true);
       
        
        
        
        
    }//GEN-LAST:event_bt_nuevoBaseActionPerformed

    private void bt_nuevoBaseMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_nuevoBaseMouseClicked
       jd_inicio.setVisible(false);
       this.setVisible(false);
        expandir(jd_espaciodetrabajo);
        
        
    }//GEN-LAST:event_bt_nuevoBaseMouseClicked

    private void bt_nuevopginicioMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_nuevopginicioMouseClicked
        
        jd_inicio.setVisible(false);
        expandir(jd_espaciodetrabajo);
        
    }//GEN-LAST:event_bt_nuevopginicioMouseClicked

    private void bt_cuentapginicioMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_cuentapginicioMouseClicked
       jl_usuarioCuenta.setText(ingresoUsuario);
        jl_contraseñaCuenta.setText(ingresoContraseña);
        expandir(jd_cuenta);
        
    }//GEN-LAST:event_bt_cuentapginicioMouseClicked

    private void tp_sqlInputMethodTextChanged(java.awt.event.InputMethodEvent evt) {//GEN-FIRST:event_tp_sqlInputMethodTextChanged
        
    }//GEN-LAST:event_tp_sqlInputMethodTextChanged

    private void bt_sendMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_sendMouseClicked
        System.out.println("pepelobo");
        try {
            String palabras [] = tp_sql.getText().split(" ");
        } catch (IndexOutOfBoundsException e) {
            jd_error.setVisible(true);
            jl_error.setText("NO ingreso los campos de la tabla");
        }
        
        String palabras [] = tp_sql.getText().split(" ");//split de los comandos
        
        DefaultTreeModel arbol = (DefaultTreeModel) jtree_baseddatos.getModel();
        DefaultMutableTreeNode raiz = (DefaultMutableTreeNode) arbol.getRoot();
        
        if (palabras[0].equals("CREATE") && palabras[1].equals("DATABASE")){
            boolean entro = false; 
            for (int i = 0; i < userActual.getPermisos().size(); i++) {
                if (userActual.getPermisos().get(i).equalsIgnoreCase("Create")) {
                    limpiezaNueva();
                    DefaultMutableTreeNode basenueva = new DefaultMutableTreeNode(new BasedeDatos(palabras[2]));
                    raiz.add(basenueva);
                    arbol.reload();
                    nodo_seleccionado = basenueva; 
                    //base_seleccionada = (BasedeDatos) nodo_seleccionado.getUserObject();
                    tp_sql.setText("");
                    JOptionPane.showMessageDialog(jd_espaciodetrabajo, "Base de datos creada exitosamente");
                    entro = true; 
                }
            }
            if (entro == false) {
                jl_error.setText("No tiene permiso para crear bases de datos");
                expandir(jd_error);
                tp_sql.setText("");
            }
        }
        //validar que seleccione una base pa poder crear una tabla dentro de esto
        else if (palabras[0].equals("CREATE") && palabras[1].equals("TABLE")) {
            //Comando #CREATE TABLE nombre_tabla  (campo1, campo2, campo3....campo-n)
            boolean entro = false;

            for (int i = 0; i < userActual.getPermisos().size(); i++) {
                if (userActual.getPermisos().get(i).equalsIgnoreCase("Create")) {
                    limpiezaNueva();
                    
                    try {
                        String[] campos1 = tp_sql.getText().split("\\(");// CRT TABL nombre (   ||  campo1, campo2, campo3....campo-n)     
                        String[] campos2 = campos1[1].split("\\)"); //campo1, campo2, campo3....campo-n  ||   )
                        String[] campos = campos2[0].split(","); //campo1 || campo2 || campon
                        String[] nombre = palabras[2].split("\\("); //nombre[0] es el nombre del archivo
                        File archivo = null;
                        FileWriter fw = null;
                        BufferedWriter bw = null;
                        
                        try {
                            Date f = new Date();
                            SimpleDateFormat sd = new SimpleDateFormat("dd/MMMM/yyyy");
                            String fecha = sd.format(f);
                            
                            archivo = new File (nombre[0]+".txt");
                            fw = new FileWriter(archivo);
                            bw = new BufferedWriter(fw);
                            
                            bw.write("★ENCABEZADO");
                            bw.newLine();
                            bw.write("nombre: " + nombre[0]);
                            bw.newLine();
                            bw.write("creador(a): " + userActual.getUsuario());
                            bw.newLine();
                            bw.write("fecha_creacion: " + fecha);
                            bw.newLine();
                            bw.write("atributos: " + campos2[0]);
                            bw.newLine();
                            bw.newLine();
                            
                         

                            bw.write("★DETALLE");
                            bw.newLine();
                            
                            bw.flush();
                            bw.close();
                            fw.close();
                            
                        } catch (Exception e) {
                            e.printStackTrace();
                        }
                        System.out.println(archivo.getPath());
                        
                        DefaultTableModel tabla = (DefaultTableModel) tabla_esptrabajo.getModel();
                        DefaultTableModel modelo_a = tabla;
                        
                        for (int j = 0; j < campos.length; j++) {
                            modelo_a.addColumn(campos[j]);
                        }

                        tabla_esptrabajo.setModel(modelo_a);
//            Object v1 = jtree_baseddatos.getSelectionPath().getLastPathComponent();
//            nodo_seleccionado = (DefaultMutableTreeNode) v1;

                            DefaultMutableTreeNode archv = new DefaultMutableTreeNode(archivo);
                        nodo_seleccionado.add(archv);

                        arbol.reload();

                    } catch (IndexOutOfBoundsException e) {
                        jl_error.setText("No ingreso los campos de la tabla");
                        expandir(jd_error);
                    }
                    entro=true;
                }
            }

            if (entro == false) {
                jl_error.setText("No tiene permiso para crear tablas");
                expandir(jd_error);
                tp_sql.setText("");
            }

        } else if (palabras[0].equals("INSERT") && palabras[1].equals("INTO") && palabras[3].equals("VALUES")) {
            //Comando #INSERT INTO nombre_tabla VALUES(valor1, valor2, valor3......valorn)
            boolean entro = false; 
            for (int i = 0; i < userActual.getPermisos().size(); i++) {
                if (userActual.getPermisos().get(i).equals("Insert")) {
                    String nombretab = palabras[2];
                    String[] campos1 = palabras[4].split("\\(");
                    String[] campos2 = campos1[1].split("\\)"); //campo1, campo2, campo3....campo-n  ||   )
                    
                    String[] campos = campos2[0].split(",");

                    DefaultTreeModel modeloArbol = (DefaultTreeModel)jtree_baseddatos.getModel(); 
                    DefaultMutableTreeNode nodoRaiz = (DefaultMutableTreeNode)modeloArbol.getRoot(); 
                    for (int j = 0; j < nodoRaiz.getChildCount(); j++) {
                        DefaultMutableTreeNode hijo = (DefaultMutableTreeNode)nodoRaiz.getChildAt(j); 
                        if (hijo.getChildCount() > 0) {
                            for (int k = 0; k < hijo.getChildCount(); k++) {
                                DefaultMutableTreeNode hijoDelhijo = (DefaultMutableTreeNode)hijo.getChildAt(k); 
                                if (((File) hijoDelhijo.getUserObject()).getPath().equals(nombretab+".txt")) {
                                    File archivo = null;
                                    FileWriter fw = null;
                                    BufferedWriter bw = null;

                                    try {
                                        archivo = new File(palabras[2] + ".txt");
                                        fw = new FileWriter(archivo, true);
                                        bw = new BufferedWriter(fw);
                                        bw.write(campos2[0]+"\n");
                                        
                                        bw.flush();
                                        bw.close();
                                        fw.close();

                                    } catch (Exception e) {
                                        e.printStackTrace();
                                    }
                                }
                            }//cierre del for del hijo de los hijos
                        }
                        
                    }//cierre del for del hijo de la raiz
                    entro = true; 
                    reflejar(nombretab+".txt");
                }//cierre del if permisos
            }//cierre for permisos
            if (entro == false) {
                jl_error.setText("No tiene el permiso para insertar informacion");
                expandir(jd_error);
            }

        } else if (palabras[0].equals("DROP") && palabras[1].equals("DATABASE")) {
            boolean entro = false; 
            for (int j = 0; j < userActual.getPermisos().size(); j++) {
                if (userActual.getPermisos().get(j).equals("Drop")) {
                    String nombreBase = palabras[2];
                    DefaultTreeModel modeloArbol = (DefaultTreeModel) jtree_baseddatos.getModel();
                    DefaultMutableTreeNode raiz2 = (DefaultMutableTreeNode) modeloArbol.getRoot();
                    for (int i = 0; i < raiz2.getChildCount(); i++) {
                        DefaultMutableTreeNode temp = (DefaultMutableTreeNode) raiz2.getChildAt(i);
                        if (temp.getUserObject() instanceof BasedeDatos) {

                            BasedeDatos p = (BasedeDatos) temp.getUserObject();
                            if (p.getNombre().equals(nombreBase)) {

                                raiz2.remove(i);
                            }
                        }
                        modeloArbol.reload();
                    }
                    entro = true; 
                }
            }//cierre for si tiene permiso
            if (entro == false) {
                jl_error.setText("No tiene permiso para DROP bases");
            }

        } else {
            JOptionPane.showMessageDialog(jd_espaciodetrabajo, "El texto ingresado no es un comando SQL. \n Ingrese el comando nuevamente");

        }

        tp_sql.setText("");


    }//GEN-LAST:event_bt_sendMouseClicked

    private void bt_clearMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_clearMouseClicked
        tp_sql.setText("");
    }//GEN-LAST:event_bt_clearMouseClicked

    private void jtree_baseddatosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jtree_baseddatosMouseClicked
        if (!(jtree_baseddatos.isSelectionEmpty())) {
            int row = jtree_baseddatos.getClosestRowForLocation(evt.getX(), evt.getY());
            jtree_baseddatos.setSelectionRow(row);
            Object v1 = jtree_baseddatos.getSelectionPath().getLastPathComponent();
            nodo_seleccionado = (DefaultMutableTreeNode) v1;

            if (nodo_seleccionado.getUserObject() instanceof BasedeDatos) {
                //System.out.println("Esta es una base de datos");
                base_seleccionada = (BasedeDatos) nodo_seleccionado.getUserObject();
                if (evt.isMetaDown()) {
                    popup_opcionesBases.show(evt.getComponent(), evt.getX(), evt.getY());

                }
                   
            }else if (nodo_seleccionado.getUserObject() instanceof DefaultTableModel){ 
                //System.out.println("9");
                //limpiezaNueva();
                //DefaultTableModel m = (DefaultTableModel)nodo_seleccionado.getUserObject();
                //JTable tabla = tabla_esptrabajo; 
                DefaultTableModel tablagui = (DefaultTableModel) tabla_esptrabajo.getModel();
                tablagui.setColumnCount(0);
                tabla_esptrabajo.setModel(tablagui);
                
                DefaultTableModel m = (DefaultTableModel)nodo_seleccionado.getUserObject();
                tabla_esptrabajo.setModel(m);
                System.out.println(m.getColumnCount());
              
            }
             //System.out.println("-------------------");
            //System.out.println(nodo_seleccionado.getUserObject());
        }
         
    }//GEN-LAST:event_jtree_baseddatosMouseClicked

    private void bt_newdatabaseMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_newdatabaseMouseClicked
        DefaultTreeModel arbol = (DefaultTreeModel) jtree_baseddatos.getModel();
        DefaultMutableTreeNode raiz = (DefaultMutableTreeNode) arbol.getRoot();
        
        DefaultMutableTreeNode basenueva = new DefaultMutableTreeNode(new BasedeDatos(JOptionPane.showInputDialog("Nombre de la base de datos")));
        raiz.add(basenueva);
        arbol.reload();
        JOptionPane.showMessageDialog(jd_espaciodetrabajo, "Base de datos creada exitosamente");

    }//GEN-LAST:event_bt_newdatabaseMouseClicked

    private void bt_newdatabase1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_newdatabase1MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_newdatabase1MouseClicked

    private void jmi_eliminarbaseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_eliminarbaseActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jmi_eliminarbaseActionPerformed

    private void jl_abrirMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jl_abrirMouseClicked
        JFileChooser fileChooser = new JFileChooser();
    }//GEN-LAST:event_jl_abrirMouseClicked

    private void bt_crearActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_crearActionPerformed
       
        Usuario user = new Usuario(tf_crearnombreusuario.getText(), pf_contracrearusuario.getText()); 
        user.getPermisos().add("Gestion de Nuevos Usuarios"); 
        user.getPermisos().add("Create"); 
        user.getPermisos().add("Select"); 
        user.getPermisos().add("Insert"); 
        user.getPermisos().add("Delete"); 
        user.getPermisos().add("Drop"); 
        usuarios.add(user);
        tf_crearnombreusuario.setText("");
        pf_contracrearusuario.setText("");
        JOptionPane.showMessageDialog(jd_crearusuario, "Usuario creado exitosamente");
        jd_crearusuario.setVisible(false);
        tf_usuarioo.setText("");
        pf_contra.setText("");
        
        this.setVisible(true);  
    }//GEN-LAST:event_bt_crearActionPerformed

    private void bt_ingresarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_ingresarActionPerformed
        
        if (usuarios.isEmpty()) {
            jl_error.setText("No existen usuarios, cree uno");
            expandir(jd_error);
        } else {
            for (int i = 0; i < usuarios.size(); i++) {
                if (usuarios.get(i).getUsuario().equals(tf_usuarioo.getText()) && usuarios.get(i).getContrasenia().equals(pf_contra.getText())) {
                    userActual = usuarios.get(i); 
                    System.out.println(userActual);
                    jl_bienvenido.setText(tf_usuarioo.getText());
                    ingresoUsuario = tf_usuarioo.getText(); 
                    ingresoContraseña = pf_contra.getText();
                    this.setVisible(false);
                    expandir(jd_inicio);
                }
                
            }

        }
        arbolLleno();
        
        tf_usuarioo.setText("");
        pf_contra.setText("");
        

                     
    }//GEN-LAST:event_bt_ingresarActionPerformed

    private void bt_notengousuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_notengousuarioActionPerformed
        
        this.setVisible(false);
        expandir(jd_crearusuario);
    }//GEN-LAST:event_bt_notengousuarioActionPerformed

    private void pf_contraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pf_contraActionPerformed
         boolean userExiste = false; 
        if (usuarios.isEmpty()) {
            jl_error.setText("No existen usuarios, cree uno");
            expandir(jd_error);
        } else {
            for (int i = 0; i < usuarios.size(); i++) {
                if (usuarios.get(i).getUsuario().equals(tf_usuarioo.getText()) && usuarios.get(i).getContrasenia().equals(pf_contra.getText())) {
                    userActual = usuarios.get(i); 
                    jl_bienvenido.setText(tf_usuarioo.getText());
                    ingresoUsuario = tf_usuarioo.getText(); 
                    ingresoContraseña = pf_contra.getText();
                    this.setVisible(false);
                    System.out.println(userActual);
                    expandir(jd_inicio);
                    userExiste = true; 
                   
                }
                
            }
            if (userExiste == false) {
                jl_error.setText("El usuario que ingreso no existe");
                expandir(jd_error);
           }

        }
        arbolLleno();
        
        
        tf_usuarioo.setText("");
        pf_contra.setText("");  
    }//GEN-LAST:event_pf_contraActionPerformed

    private void bt_crearuserBaseMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bt_crearuserBaseMouseClicked
        Usuario temp = new Usuario(tf_usuarioBase.getText(), pf_contraUser.getText()); 
        if (cb_gestionUsuarios.isSelected()) {
            temp.getPermisos().add(cb_gestionUsuarios.getText());
        }
        if (cb_create.isSelected()) {
            temp.getPermisos().add(cb_create.getText());
        }
        if (cb_select.isSelected()) {
            temp.getPermisos().add(cb_select.getText());
        }
        if (cb_insert.isSelected()) {
            temp.getPermisos().add(cb_insert.getText());
        }
        if (cb_delete1.isSelected()) {
            temp.getPermisos().add(cb_delete1.getText());
        }
        if (cb_drop.isSelected()) {
            temp.getPermisos().add(cb_drop.getText());
        }
        usuarios.add(temp); 
        System.out.println(usuarios);
        System.out.println(temp.getPermisos());
        jd_baseUsuarios.setVisible(false);
        
    }//GEN-LAST:event_bt_crearuserBaseMouseClicked

    private void jmi_AgregarUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_AgregarUsuarioActionPerformed
        expandir(jd_baseUsuarios); 
        
    }//GEN-LAST:event_jmi_AgregarUsuarioActionPerformed

    private void jmi_cambiarUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_cambiarUsuarioActionPerformed
        jd_espaciodetrabajo.setVisible(false);
        this.setVisible(true);
        
    }//GEN-LAST:event_jmi_cambiarUsuarioActionPerformed

   
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(PaginaInicio.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(PaginaInicio.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(PaginaInicio.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(PaginaInicio.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new PaginaInicio().setVisible(true);
            }
        });
    }
    
    public void reflejar(String nom){
        File archivo = null; 
        FileReader fr = null; 
        BufferedReader br = null; 
        try {
            archivo = new File(nom); 
            fr = new FileReader(archivo);
            br = new BufferedReader(fr); 
            String lin = ""; 
            br.readLine(); 
            br.readLine(); 
            br.readLine(); 
            br.readLine(); 
            br.readLine(); 
            
            br.readLine(); 
            br.readLine(); 
            DefaultTableModel m = (DefaultTableModel)tabla_esptrabajo.getModel();
            while ((lin = br.readLine()) != null) {
                String [] n = lin.split(","); 
                m.addRow(n);
            }
            tabla_esptrabajo.setModel(m);
            
        } catch (Exception e) {
            e.printStackTrace();
        }
        
        
    }
    
    public void limpiezaNueva(){
        DefaultTableModel modeli = (DefaultTableModel)tabla_esptrabajo.getModel(); 
        modeli.setColumnCount(0);
        tabla_esptrabajo.setModel(modeli);
        
    
    }
    
    public void arbolLleno(){
        DefaultTreeModel modeloArbol = (DefaultTreeModel)jt_ArbolInicio.getModel();
        File p = new File("."); 
        File [] x = p.listFiles(); 
        DefaultMutableTreeNode nodoRaiz = (DefaultMutableTreeNode)modeloArbol.getRoot(); 
        for (File t : x) {
            if (t.getPath().contains(".txt")) {
                DefaultMutableTreeNode nodoFIle = new DefaultMutableTreeNode(t.getName()); 
                nodoRaiz.add(nodoFIle);
            }
        }
        modeloArbol.setRoot(nodoRaiz);
    
    }
//    public void arbolrefresh (){
//        DefaultTreeModel arbol = (DefaultTreeModel) jt_ArbolInicio.getModel();
//        DefaultMutableTreeNode raiz = (DefaultMutableTreeNode) arbol.getRoot();
//        File carp = new File(".");
//        File archivos[] = carp.listFiles();
//        if (archivos != null) {
//            for (int i = 0; i < archivos.length; i++) {
//                if (archivos[i].getPath().endsWith("txt")) {
//                    DefaultMutableTreeNode nodo = new DefaultMutableTreeNode(archivos[i]);
//                    raiz.add(nodo);
//                }
//            }
//        }
//        arbol.reload();
//    }
    
    public void expandir (JDialog x){
        x.pack();
        x.setLocationRelativeTo(this);
        x.setModal(true);
        x.setVisible(true);
        
    }
 
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton bt_abrirpginicio;
    private javax.swing.JButton bt_clear;
    private javax.swing.JButton bt_crear;
    private javax.swing.JButton bt_crearuserBase;
    private javax.swing.JButton bt_cuentapginicio;
    private javax.swing.JButton bt_ingresar;
    private javax.swing.JButton bt_iniciopginicio;
    private javax.swing.JButton bt_newdatabase;
    private javax.swing.JButton bt_newdatabase1;
    private javax.swing.JButton bt_notengousuario;
    private javax.swing.JButton bt_nuevoBase;
    private javax.swing.JButton bt_nuevopginicio;
    private javax.swing.JButton bt_ok;
    private javax.swing.JButton bt_opcionespginicio;
    private javax.swing.JButton bt_send;
    private javax.swing.JCheckBox cb_create;
    private javax.swing.JCheckBox cb_delete1;
    private javax.swing.JCheckBox cb_drop;
    private javax.swing.JCheckBox cb_gestionUsuarios;
    private javax.swing.JCheckBox cb_insert;
    private javax.swing.JCheckBox cb_select;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenu jMenu3;
    private javax.swing.JMenu jMenu4;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuBar jMenuBar2;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTabbedPane jTabbedPane2;
    private javax.swing.JTabbedPane jTabbedPane3;
    private javax.swing.JToolBar jToolBar1;
    private javax.swing.JToolBar jToolBar2;
    private javax.swing.JDialog jd_baseUsuarios;
    private javax.swing.JDialog jd_crearusuario;
    private javax.swing.JDialog jd_cuenta;
    private javax.swing.JDialog jd_error;
    private javax.swing.JDialog jd_espaciodetrabajo;
    private javax.swing.JDialog jd_inicio;
    private javax.swing.JLabel jl_abrir;
    private javax.swing.JLabel jl_bienvenido;
    private javax.swing.JLabel jl_contraseñaCuenta;
    private javax.swing.JLabel jl_error;
    private javax.swing.JLabel jl_usuarioCuenta;
    private javax.swing.JMenuItem jmi_AgregarTabla;
    private javax.swing.JMenuItem jmi_AgregarUsuario;
    private javax.swing.JMenuItem jmi_cambiarUsuario;
    private javax.swing.JMenuItem jmi_eliminarBase;
    private javax.swing.JMenuItem jmi_eliminarbase;
    private javax.swing.JTree jt_ArbolInicio;
    private javax.swing.JTree jtree_baseddatos;
    private javax.swing.JPasswordField pf_contra;
    private javax.swing.JPasswordField pf_contraUser;
    private javax.swing.JPasswordField pf_contracrearusuario;
    private javax.swing.JPopupMenu popup_opcionesBases;
    private javax.swing.JPopupMenu popup_tablasenarbol;
    private javax.swing.JTable tabla_esptrabajo;
    private javax.swing.JTextField tf_crearnombreusuario;
    private javax.swing.JTextField tf_usuarioBase;
    private javax.swing.JTextField tf_usuarioo;
    private javax.swing.JTextPane tp_sql;
    // End of variables declaration//GEN-END:variables
    
    protected String ingresoUsuario; 
    protected String ingresoContraseña;
    protected Usuario userActual; 
    protected BasedeDatos base_seleccionada;
    protected DefaultMutableTreeNode nodo_seleccionado;
    protected File archivoActual;
    

}
